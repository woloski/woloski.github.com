--- 
layout: post
title: "DelegatingHandler vs HttpOperationHandler \xE2\x80\x93 WCF Web API"
published: true
meta: 
  _wp_old_slug: ""
tags: 
- WCF Web API
type: post
status: publish
---
<p>Yesterday <a href="http://haacked.com">Phil Haack</a> wrote a post about <a href="http://haacked.com/archive/2011/10/19/implementing-an-authorization-attribute-for-wcf-web-api.aspx">Implementing an Authorization Attribute for WCF Web API</a>. We’re doing something similar to handle auth using SimpleWebTokens handled by <a href="http://www.google.com.ar/url?sa=t&amp;rct=j&amp;q=windows%20azure%20acs&amp;source=web&amp;cd=1&amp;ved=0CCsQFjAA&amp;url=http%3A%2F%2Facs.codeplex.com%2F&amp;ei=8EegTtjYJKTz0gHMg5HjBA&amp;usg=AFQjCNFAQwynNtM6Ip3ttXMKIqQSPlPJzg&amp;sig2=S9WqL107lA2OIat13tr_hA">ACS</a> and found a mix of approaches between <a href="http://pfelix.wordpress.com/2011/10/08/wcf-web-apibuilding-an-authorize-attribute/">Pedro Felix</a>, <a href="http://codebetter.com/howarddierking/2011/10/11/oauth-2-0-in-web-api/">Howard’s post</a>, <a href="https://bitbucket.org/lewisbenge/wcf-web-api-oauth-integration">Lewis</a>, and <a href="http://blogs.southworks.net/jhalife">Johnny</a>’s team who is also working on something similar. However I was too lazy to read the blogs and thrown this out to twitter knowing that <a href="http://twitter.com/gblock">@gblock</a> would give me the answer I wanted in matter of minutes <img style="border-bottom-style: none;border-left-style: none;border-top-style: none;border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="http://blogs.southworks.net/mwoloski/files/2011/10/wlEmoticon-smile.png"></p> <blockquote> <p><strong>@woloski:</strong> when would you use a <font color="#ff0000"></font><font color="#ff0000">delegatingchannel</font> vs <font color="#00ff00"></font><font color="#00ff00">httpoperationhandler</font><font color="#00ff00"></font>? I've found different samples using both</p></blockquote> <p>And indeed he replied. I like things explained in plain English from someone who really knows the thing, so here are the tweets with some color coding to separate one from the other. </p> <p><strong>NOTE</strong>: make sure to also read <a href="http://codebetter.com/glennblock/2011/05/17/message-handlers-vs-operation-handlers-which-one-to-use-2/">Glenn’s post which goes into much more detail</a>.</p> <blockquote> <p><strong>@gblock</strong>: there are significant diffs. One is for <font></font><font>pure <font color="#ff0000">http request / resp related concerns</font></font><font color="#ff0000"> </font>(message handlers) the other for <font></font><font color="#00ff00">app level</font><font></font></p> <p><strong>@gblock: </strong>one is <font></font><font color="#ff0000">global / knows nothing about the service</font><font></font> the other does <font></font><font color="#00ff00">knows about the service</font><font></font>.</p> <p><strong>@gblock: </strong>one is a <font></font><font color="#ff0000">Russian doll allowing pre-post handling</font><font></font>, the other is a <font></font><font color="#00ff00">sequential pipeline</font><font></font>.</p> <p><strong>@gblock: </strong>one <font></font><font color="#00ff00"><font>handles model binding type scenarios</font> </font>(operation handlers) <font></font><font color="#ff0000">the other does not</font><font></font></p> <p><strong>@gblock: </strong>one is <font></font><font color="#ff0000"><font>async</font> </font>(message handlers) the other is <font></font><font color="#00ff00">sync</font><font></font>. So if you have something <font></font><font color="#ff0000"><font>io bound</font> </font>use message handlers</p> <p><font></font><strong>@gblock: </strong><font color="#ff0000"><font>for cross cutting http concerns like etags, or if-none-match</font> </font>use message handlers.</p> <p><font></font><strong>@gblock: </strong><font color="#00ff00">for validation / logging of app data</font><font></font> use operation handlers. <font></font><font color="#0000ff">For security you might use both</font><font></font> as Howard did for Oauth</p> <p><strong>@gblock: </strong>if it is <font></font><font color="#ff0000">truly cross cutting and doesn't require details about the operation</font><font></font> itself like parameter values.</p> <p><strong>@gblock: </strong>message handlers can <font></font><font color="#ff0000"><font>handle </font><font>requests dynamically</font></font><font></font> ie they can handle a request to \foo without an op foo</p> <p><strong>@gblock: </strong>architecturally I think they make sense even though there is some overlap. <font><font></font></font><font><font color="#ff0000"><font>HTTP concerns</font> </font></font><font></font>vs <font><font></font></font><font><font color="#00ff00"><font>app concerns</font> </font></font><font></font>is the line.</p></blockquote> <p>For our case we will use HttpOperationHandlers because we want access to the operation to check that it contains an attribute.</p> <p>Case closed!</p>
