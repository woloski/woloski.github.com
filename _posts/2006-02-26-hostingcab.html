--- 
layout: post
title: "HowTo: Host a CAB application in Outlook, Word, Excel, or a common Winforms application"
published: true
meta: {}

tags: 
- CAB
type: post
status: publish
---
<div class="Section1"><b><span style="font-size: 10pt;font-family: arial">Introduction</span></b>     <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Reusing is       <br />a common requirement in any team or framework. However, we usually reuse at        <br />business logic or general infrastructure level. The User Interface reuse is        <br />more difficult to achieve. <a href="http://codegallery.gotdotnet.com/cab">CAB</a> architecture is loosely coupled enough to make        <br />that possible.</span></p>    <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial">The       <br />following screenshots illustrates the bank teller quickstart application hosted        <br />in Outlook, Word and a regular Winforms application. </span></p>    <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Just two       <br />lines of code [:)] </span><span style="font-size: 10pt;font-family: wingdings"></span></p>    <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial">&#160;</span></p>    <p class="MsoNormal"><a href="http://blogs.southworks.net/mwoloski/files/2008/06/ho1.jpg"><img height="312" alt="ho1" src="http://blogs.southworks.net/mwoloski/files/2008/06/ho1-thumb.jpg" width="449" border="0" /></a> <a href="/photos/blog_gallery/images/224/original.aspx"><span style="font-size: 10pt;font-family: arial"></span></a><a href="http://blogs.southworks.net/mwoloski/files/2008/06/ho2.jpg"><img height="278" alt="ho2" src="http://blogs.southworks.net/mwoloski/files/2008/06/ho2-thumb.jpg" width="490" border="0" /></a> </p>    <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial"></span>      <p></p>   </p>    <p class="MsoNormal"><a href="http://blogs.southworks.net/mwoloski/files/2008/06/ho3.jpg"><img height="280" alt="ho3" src="http://blogs.southworks.net/mwoloski/files/2008/06/ho3-thumb.jpg" width="502" border="0" /></a> <a href="/photos/blog_gallery/images/226/original.aspx"><span style="font-size: 10pt;font-family: arial"></span></a><a href="http://blogs.southworks.net/mwoloski/files/2008/06/ho4.jpg"><img height="360" alt="ho4" src="http://blogs.southworks.net/mwoloski/files/2008/06/ho4-thumb.jpg" width="483" border="0" /></a> <span style="font-size: 10pt;font-family: arial"></span>      <p></p>   </p>    <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial">&#160;</span><b><span style="font-size: 10pt;font-family: arial"></span>        <p>Instructions:</p>     </b></p>    <ol style="margin-top: 0cm" type="1">     <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Download the solution</span> </li>      <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Extract         <br />the solution and <b>build it</b>. If you experience problems, check that          <br />the references to the CAB assemblies are correct.</span> </li>   </ol>    <p class="MsoNormal"><b><span style="font-size: 10pt;font-family: arial">Create         <br />the shell and the CAB application</span></b></p>    <ol style="margin-top: 0cm" type="1">     <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Create a         <br />new project to host the shell and the CAB application.           <p><i>The shell in a regular CAB application would be a Form. However if we             <br />want to host the application in a different executable (Outlook, Word, IE,              <br />etc), we already have the container. So the Shell will be a UserControl</i>.            <br /></p>       </span></li>      <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Add         <br />references to CAB assemblies.</span> </li>      <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Create a         <br />regular UserControl and place the workspaces, menus, toolstrip, statusbar,          <br />and everything related to the shell.</span> </li>      <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">If you         <br />need to override the CAB events like AfterShellCreated or          <br />AddBuilderStrategies, create a new class that derives from </span><span>CompositeUIExtensions.Hosting.<span style="color: teal">UserControlShellApplication</span>           <p></p>         <span style="font-size: 10pt;font-family: arial">where </span><span>TUserControlShell</span><span style="font-size: 10pt;font-family: arial"> is the type of the </span><span>UserControl</span><span style="font-size: 10pt;font-family: arial"> created on the previous step           <br />and </span><span>TWorkItem</span><span style="font-size: 10pt;font-family: arial"> is the root work item that           <br />must derives from </span><span>UserControlWorkItem</span><span style="font-size: 10pt;font-family: arial">.</span></span></li>   </ol>    <p class="MsoNormal"><b><span style="font-size: 10pt;font-family: arial">Consume         <br />a CAB module/app from Outlook/Word/External application</span></b></p>    <ol style="margin-top: 0cm" type="1">     <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Open your         <br />project and add references to </span><span>CompositeUIExtensions.Hosting</span><span style="font-size: 10pt;font-family: arial"> and the CAB assemblies. Also         <br />copy the project related assemblies (module assemblies for example) to the          <br />application output directory.</span> </li>      <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Creates         <br />an instance of </span><span>CompositeUIExtensions.Hosting.UserControlHost</span><span style="font-size: 10pt;font-family: arial"> and add it to the         <br />correspondent Controls collection. The following code illustrates how;           <p></p>       </span></li>   </ol>    <p><span></span>      <pre>UserControlHost plugin =<span class="kwrd"> <br />	new</span> UserControlHost();<br />&#226;&#8364;&#166;Controls.Add( plugin );<br /></pre>

    <p></p>
  </p>

  <ol style="margin-top: 0cm" type="1" start="start">
    <li class="MsoNormal"><span style="font-size: 10pt;font-family: arial">Create
        <br />the ProfileCatalog.xml, configure it with the desired module/s and set the

        <br />Build Action to CopyAlways.</span><span style="font-size: 10pt;font-family: arial">&#160;</span> </li>
  </ol>

  <p class="MsoNormal"><span style="font-size: 10pt;font-family: arial"><a href="http://www.southworks.net/matiaswoloski/content/binary/Hosting%20CAB.zip">Download
        <br />the solution</a> that shows how to host the BankTeller app inside Outlook, Word and

      <br />Winforms.</span>

    <p></p>
  </p>
</div>
